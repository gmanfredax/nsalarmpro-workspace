:root{
  --bg:#0b1220;
  --panel:#0f172a;
  --panel-2:#0a1224;
  --border:#1f2a44;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --accent:#22d3ee;
  --accent-2:#10b981;
  --danger:#ef4444;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Apple Color Emoji','Segoe UI Emoji';
  background: radial-gradient(1200px 800px at 20% -10%, #0d1b3a 0%, transparent 60%) , var(--bg);
  color:var(--text);
}

body.auth-body{display:flex;flex-direction:column;min-height:100vh;}
.auth-main{flex:1 0 auto;display:flex;/*align-items:center;*/justify-content:center;padding:6vh 0;}
.site-header.minimal{position:static;background:transparent;border-bottom:0;box-shadow:none;}
.site-header.minimal .head-inner{padding:18px 0;}
.site-header.minimal .brand-name{font-size:1.1rem;}

.app{min-height:100vh;}
.app .main{flex:1 0 auto;}

.muted{color:var(--muted);}
.title{font-size:1.9rem;margin:0 0 .4rem;letter-spacing:.2px;}

input,button,select,textarea{font:inherit;}
.form input{background:#0d1525;border:1px solid var(--border);color:var(--text);padding:.6rem .75rem;border-radius:12px;transition:border-color .2s,box-shadow .2s;}
.form input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 2px rgba(34,211,238,.25);}

.prefix-input{display:flex;align-items:center;gap:.55rem;background:#0d1525;border:1px solid var(--border);border-radius:14px;padding:.55rem .75rem;}
.prefix-input .prefix{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:.85rem;color:var(--muted);white-space:nowrap;}
.prefix-input input{flex:1;background:transparent;border:0;padding:0;color:inherit;font:inherit;outline:none;min-width:0;}
.prefix-input input.input-readonly{color:var(--muted);cursor:default;}

.row{display:flex;align-items:center;gap:.75rem;}
.row.between{justify-content:space-between;}
.actions{display:flex;justify-content:flex-end;gap:.75rem;margin-top:.75rem;}

/* util */
.hidden { display: none !important; }
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
body.modal-open { overflow: hidden; }

/* overlay scuro sopra tutta la pagina */
.cover{position:fixed; inset:0; background:rgba(0,0,0,.25); backdrop-filter:blur(2px); z-index:950}

/* menÃ¹ utente */
.user.open .user-menu { display:block; }
.user-menu {
  position:absolute; right:0; top:calc(100% + .5rem);
  min-width: 180px; background:var(--panel-bg,#0f1824); border:1px solid rgba(255,255,255,.06);
  border-radius:.6rem; box-shadow:0 10px 30px rgba(0,0,0,.3); z-index:999;
}
.user-menu button {
  width:100%; text-align:left; background:transparent; border:0; padding:.7rem .9rem; color:#cfe6ff;
}
.user-menu button:hover { background:rgba(255,255,255,.06); }
/* User dropdown */
.user.user-menu { position: relative; }
.user-btn { background: transparent; border: 0; color: var(--fg,#cfe6ff); display:flex; gap:.4rem; align-items:center; }
#userLabel{display:inline-flex;align-items:center;gap:.45rem;}
#userLabel .user-name{font-weight:600;letter-spacing:.2px;}
#userLabel .user-role{font-size:.7rem;letter-spacing:.08em;text-transform:uppercase;}
.dropdown {
  position: absolute; right: 0; top: calc(100% + .5rem);
  min-width: 200px; background: var(--panel-bg,#0f1824);
  border: 1px solid rgba(255,255,255,.06); border-radius: .6rem;
  box-shadow: 0 12px 30px rgba(0,0,0,.35); z-index: 999;
}
.dropdown.hidden { display: none; }
.dropdown > button {
  width: 100%; text-align: left; background: transparent; border: 0;
  padding: .7rem .9rem; color: #cfe6ff;
}
.dropdown > button:hover { background: rgba(255,255,255,.06); }
.dropdown button{
  display:block; width:100%; text-align:left; padding:.6rem .8rem; border:0; background:transparent; color:#cfd7e6; border-radius:10px; cursor:pointer;
}
.dropdown button:hover{background:rgba(255,255,255,.06); color:#fff}
.dropdown-divider{height:1px;background:rgba(255,255,255,.08);margin:.35rem 0;}

/* modali generiche */
.modal-overlay{position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:9999; backdrop-filter:blur(3px); background:rgba(0,0,0,.15)}
.modal{min-width:400px; max-width:min(92vw,520px)}
.modal.confirm-modal{max-width:min(92vw,420px);}
.modal.zones-config-modal{max-width:min(96vw,760px);}
body.modal-open{overflow:hidden;}
.form .row{display:flex; gap:.5rem; align-items:center}
.form .field{display:flex; flex-direction:column; gap:.35rem; margin:.35rem 0}
.form .field span{font-size:.85rem; opacity:.8}

/* pannello login centrato */
.login-panel {
  /*position: fixed;
  inset: 0;
  display: grid;*/
  place-items: end center;            /* in basso come nel tuo mock */
  padding: 2rem 1rem;
  z-index: 1000;
}
.login-card {
  width: min(920px, 96vw);
  margin: 0 auto;
  border-radius: 18px;
  /* riusa le tue classi .card (ombre, bordi) */
}
.login-card .field input { width:100%; }

.login-card h3 { margin: 0 0 .75rem; }
.login-card .row { display: flex; gap: .75rem; align-items: center; }
.login-card .actions { justify-content: flex-start; margin-top: .75rem; }
.msg{margin-top:.5rem;}
.msg.small{font-size:.85rem; opacity:.9}

.container{max-width:1120px;margin:0 auto;padding:0 20px}
.site-header{
  position:sticky;top:0;z-index:20;
  background:linear-gradient(to bottom, rgba(12,20,40,.9), rgba(12,20,40,.6));
  border-bottom:1px solid var(--border);
  backdrop-filter:saturate(140%) blur(6px);
}
.head-inner{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
.brand{display:flex;align-items:center;gap:10px;font-weight:600}
.brand-name{letter-spacing:.2px}
.brand-text{display:flex;flex-direction:column;gap:.1rem;}
.brand-label{font-weight:600;letter-spacing:.2px;}
.brand-sub{font-size:.75rem;color:var(--muted);letter-spacing:.35px;text-transform:uppercase;}
/*.user{display:flex;align-items:center;gap:10px;color:#cbd5e1;font-size:.9rem}*/
.user { position:relative; cursor:pointer; }

.ico{width:22px;height:22px;color:var(--accent)}
.ico.s{width:18px;height:18px}
.ico.ok{color:var(--accent-2)}

.btn{
  border:1px solid var(--border);background:var(--panel);color:var(--text);
  padding:.5rem .9rem;border-radius:12px;cursor:pointer;transition:.2s;
}
.btn-group{display:flex;gap:.4rem;flex-wrap:wrap;}
.btn.toggle{background:rgba(13,21,37,.85);border-color:rgba(255,255,255,.08);color:var(--muted);}
.btn.toggle.active{color:var(--accent);border-color:var(--accent);box-shadow:0 0 0 1px rgba(34,211,238,.25);background:rgba(12,36,64,.85);}
.btn.outline{background:transparent}
.btn.small{padding:.35rem .6rem;font-size:.85rem;border-radius:10px}
.btn.primary{border-color:transparent;background:linear-gradient(180deg, #20e0ff, #0ea5b7);color:#00141e;font-weight:600;}
.btn.secondary{border-color:transparent;background:#1e293b;color:#e2e8f0;}
.btn.danger{border-color:transparent;background:linear-gradient(180deg,#ef4444,#b91c1c);color:#fff;font-weight:600;}
.btn.wide{width:100%;justify-content:center;}
.btn.tiny{border-radius:8px;}
.btn:hover{transform:translateY(-1px)}

.main{padding:28px 0}
.tabs{display:flex;gap:10px}
.toolbar{display:flex;gap:10px;align-items:center;}
.tab-btn{
  cursor: pointer;
  border:1px solid var(--border);background:#0d1525;color:#d1d5db;
  padding:.55rem 1rem;border-radius:12px;font-size:.9rem;letter-spacing:.2px;
}
.tab-btn.active{border-color:#22d3ee;color:#a5f3fc;background:#0c2440}

.tab{display:none;margin-top:16px}
.tab.active{display:block}

/* Cards & grids */
.card{
  color: var(--text);
  border:1px solid var(--border);
  background:linear-gradient(180deg, rgba(21,31,56,.9), rgba(10,18,36,.9));
  border-radius:16px;padding:16px;
  box-shadow: 0 8px 24px rgba(0,0,0,.28);
  margin: 5px;
}
.card.mini{padding:12px}

.kpi-grid{display:grid;grid-template-columns:repeat(1,1fr);gap:16px}
@media(min-width:640px){.kpi-grid{grid-template-columns:repeat(2,1fr)}}
@media(min-width:960px){.kpi-grid{grid-template-columns:repeat(3,1fr)}}

.kpi{display:grid;gap:6px}
.kpi-title{color:var(--muted);font-size:.85rem;letter-spacing:.3px}
.kpi-value{font-size:1.8rem;font-weight:700;display:flex;align-items:center;gap:8px}
.kpi-value .alarm-zone-value{display:flex;flex-direction:column;align-items:flex-start;gap:.45rem;font-size:1rem;line-height:1.3;width:100%}
.alarm-zone-list{display:flex;flex-wrap:wrap;gap:.35rem}
.alarm-zone-pill{display:inline-flex;align-items:center;gap:.3rem;padding:.25rem .6rem;border-radius:999px;font-size:.95rem;background:linear-gradient(180deg,rgba(168,85,247,.28),rgba(88,28,135,.65));border:1px solid rgba(168,85,247,.45);color:#f5e8ff;box-shadow:0 6px 14px rgba(76,29,149,.25)}
.alarm-zone-empty{font-size:1rem;color:var(--muted)}

.mode-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:.75rem;}
@media(min-width:720px){.mode-grid{grid-template-columns:repeat(4,minmax(0,1fr));}}
.mode-btn{display:grid;place-items:center;gap:.3rem;padding:.8rem .5rem;border-radius:14px;border:1px solid rgba(255,255,255,.08);background:#0d1525;color:#e0f2ff;font-weight:600;letter-spacing:.4px;cursor:pointer;transition:transform .2s,border-color .2s,box-shadow .2s;}
.mode-btn .mode-icon{font-size:1.5rem;}
.mode-btn .mode-label{font-size:.8rem;}
.mode-btn:hover{transform:translateY(-2px);border-color:var(--accent);box-shadow:0 10px 22px rgba(0,0,0,.35);}
.mode-btn:active{transform:translateY(0);}
.mode-btn.away{background:linear-gradient(180deg,rgba(34,211,238,.12),rgba(13,23,38,.9));}
.mode-btn.home{background:linear-gradient(180deg,rgba(52,211,153,.14),rgba(13,23,38,.9));}
.mode-btn.night{background:linear-gradient(180deg,rgba(96,165,250,.14),rgba(13,23,38,.9));}
.mode-btn.custom{background:linear-gradient(180deg,rgba(244,114,182,.14),rgba(13,23,38,.9));}

.tag{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--border);padding:.2rem .5rem;border-radius:999px;font-size:.9rem}
.tag.ok{background:rgba(16,185,129,.15);border-color:rgba(16,185,129,.45);color:#c7f9d4}
.tag.warn{background:rgba(250,204,21,.16);border-color:rgba(250,204,21,.42);color:#fde68a}
.tag.err{background:rgba(239,68,68,.18);border-color:rgba(239,68,68,.45);color:#fecaca}
.tag.alarm{background:rgba(56,189,248,.18);border-color:rgba(56,189,248,.5);color:#bae6fd}

/* .zones-grid{display:ruby;grid-template-columns:repeat(2,1fr);gap:12px} */
/*.zones-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px}*/
.zones-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:16px;
}
.zones-grid .card{margin:0}
.board-sections{display:flex;flex-direction:column;gap:2.5rem}
.board-section{display:flex;flex-direction:column;gap:.85rem}
.board-header{display:flex;align-items:center;justify-content:space-between;gap:.75rem}
.board-header h4{margin:0;font-size:1.05rem;letter-spacing:.35px}
.board-actions{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap;justify-content:flex-end}
.board-meta{display:flex;align-items:center;gap:.6rem;flex-wrap:wrap}
.board-status{display:inline-flex;align-items:center;padding:.2rem .6rem;border-radius:999px;font-size:.75rem;letter-spacing:.2px;border:1px solid rgba(148,163,184,.45);background:rgba(148,163,184,.16);color:#e2e8f0}
.board-status.online{border-color:rgba(34,197,94,.45);background:rgba(34,197,94,.16);color:#bbf7d0}
.board-status.offline{border-color:rgba(248,113,113,.45);background:rgba(248,113,113,.16);color:#fecaca}
.board-status.preop{border-color:rgba(250,204,21,.45);background:rgba(250,204,21,.16);color:#fde68a}
.board-status.unknown{border-color:rgba(148,163,184,.45);background:rgba(148,163,184,.12);color:#d1d5db}
.board-count{font-size:.85rem;color:var(--muted)}
/* Badge nelle card zona (RA/RC/AE) */
/* .zones-grid .chip { position: relative; padding-right: 3.2rem; min-width: 200px;}*/
/*.zones-grid .chip { position: relative; padding-right: 3.2rem; min-width: 160px;}*/
.zones-grid .chip {
  position: relative;
  padding-right: 3.2rem;
  min-width: 0;
  width: 100%;
}
.zones-grid .badges { position:absolute; top:.35rem; right:.35rem; display:flex; gap:.25rem; }
.badge { font-size:.62rem; line-height:1; padding:.18rem .32rem; border-radius:.3rem;
  background:rgba(120,160,200,.18); border:1px solid rgba(120,160,200,.35); }
/*@media(min-width:640px){.zones-grid{grid-template-columns:repeat(3,1fr)}}
@media(min-width:960px){.zones-grid{grid-template-columns:repeat(6,1fr)}}*/

.chip{display:inline-block;border:1px solid var(--border);padding:.4rem .7rem;border-radius:12px}
.chip.on{background:var(--accent);color:#00152a;border-color:var(--accent)}
.chip.offline{background:rgba(239,68,68,.18);border-color:var(--danger);color:#fecaca}
.chip.on.offline{background:rgba(239,68,68,.35);color:#fff;border-color:var(--danger)}
.chip.alarm{background:linear-gradient(180deg,rgba(168,85,247,.22),rgba(76,29,149,.7));color:#f8e7ff;border-color:rgba(168,85,247,.6);box-shadow:0 0 0 1px rgba(168,85,247,.35),0 8px 18px rgba(76,29,149,.3)}

.log-empty.small{font-size:.85rem;padding:1rem 0;}

.modal-head{display:flex;align-items:center;justify-content:space-between;gap:.75rem;margin-bottom:.25rem}
.modal-head h3{margin:0;font-size:1.1rem;}
.modal-body{color:var(--muted);font-size:.95rem;line-height:1.45;}
.modal-message{margin:0;}
.modal-actions{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1.1rem;}
.zones-config{display:flex;flex-direction:column;gap:.75rem}
.zones-config-header{display:flex;flex-direction:column;gap:.5rem}
.zones-config-title-row{display:flex;align-items:center;justify-content:space-between;gap:.75rem;flex-wrap:wrap}
.zones-config-title-row h3{margin:0}
.zones-config-subtitle{display:flex;align-items:center;justify-content:space-between;gap:.6rem;font-size:.9rem;color:var(--muted)}
.zones-config-subtitle-meta{display:flex;align-items:center;justify-content:space-between;gap:.6rem;flex-wrap:wrap;font-size:.9rem;color:var(--muted)}
.zones-config-subtitle .subtitle-label{font-weight:600;color:var(--body)}
.zones-config-subtitle .board-count{color:inherit}
.zones-config-body{max-height:60vh;overflow:auto;padding-right:.5rem;display:flex;flex-direction:column;gap:1.25rem}
.zone-config-section{display:flex;flex-direction:column;gap:.75rem}
.zone-config-section-head{display:flex;align-items:center;justify-content:space-between;gap:.75rem}
.zone-config-grid{display:grid;gap:.75rem}
@media(min-width:600px){.zone-config-grid{grid-template-columns:repeat(auto-fill,minmax(260px,1fr));}}
.zone-config-card{border:1px solid var(--border);border-radius:14px;background:linear-gradient(180deg,rgba(18,28,48,.96),rgba(10,18,36,.96));padding:.9rem;display:flex;flex-direction:column;gap:.6rem}
.zone-config-card-head{display:flex;align-items:center;justify-content:space-between;gap:.5rem;font-size:.95rem}
.zone-config-card-head strong{font-size:1rem}
.zone-config-card .badges{margin-left:auto}
.zone-config-card .field{display:flex;flex-direction:column;gap:.35rem;font-size:.9rem}
.zone-config-card .field span{font-size:.8rem;opacity:.75}
.zone-config-options{display:flex;flex-direction:column;gap:.45rem}
.chk.compact{padding:.35rem .5rem}
.zone-config-card .field input{width:100%}
.zone-config-card input[type=number]{width:6rem}

.scenes-list{display:grid;gap:16px}
.card-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.card-head .title{display:flex;align-items:center;gap:8px}
.card-head h2{margin:0;font-size:.95rem;letter-spacing:.6px; text-transform:uppercase}

.log-list{display:flex;flex-direction:column;gap:.75rem;}
.log-entry{position:relative;border:1px solid var(--border);background:linear-gradient(180deg,rgba(24,36,60,.92),rgba(10,18,36,.94));border-radius:16px;padding:1rem 1rem 1.75rem;box-shadow:0 8px 24px rgba(0,0,0,.28);overflow:hidden;}
.log-meta{display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-size:.85rem;margin-bottom:.35rem;gap:.75rem;flex-wrap:wrap;}
.log-body{font-size:.95rem;line-height:1.45;white-space:pre-wrap;word-break:break-word;}
.log-empty{color:var(--muted);text-align:center;padding:1.5rem 0;}
.log-delete-btn{position:absolute;right:.75rem;bottom:.6rem;border:none;border-radius:999px;background:rgba(148,163,184,.14);color:rgba(226,232,240,.8);width:30px;height:30px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background .2s,color .2s,transform .2s;}
.log-delete-btn:hover{background:rgba(148,163,184,.3);color:#fda4af;transform:translateY(-1px);}
.log-delete-btn:active{transform:scale(.95);}
.log-delete-btn:disabled{opacity:.45;cursor:default;transform:none;}
.log-controls{flex-wrap:wrap;}
.log-date-filter{display:flex;align-items:center;gap:.35rem;background:rgba(15,23,42,.7);padding:.35rem .5rem;border-radius:12px;border:1px solid rgba(148,163,184,.25);}
.log-date-input{background:transparent;border:1px solid rgba(148,163,184,.25);border-radius:8px;color:#e2e8f0;padding:.25rem .4rem;font-size:.85rem;min-width:9.5rem;}
.log-date-input:focus{outline:2px solid var(--accent);border-color:var(--accent);}
.log-date-sep{color:var(--muted);font-size:.8rem;}

.checks{display:flex;flex-wrap:wrap;gap:8px}
.chk{display:flex;gap:6px;align-items:center;background:#0d1525;border:1px solid var(--border);padding:.45rem .6rem;border-radius:10px}
.chk input{accent-color:#22d3ee;width:16px;height:16px}

/* .foot{padding:26px 0 40px;color:#9aa5b1;font-size:.8rem} */
.foot{padding:26px 0 40px;color:#9aa5b1;font-size:.8rem;text-align:center;}

/* --- Stato PRE_ARM / PRE_DISARM --- */
@keyframes blinkFade { 50% { opacity: .35; } }
.blink { animation: blinkFade 1s linear infinite; }
.countdown { font-variant-numeric: tabular-nums; margin-left:.35rem; }
.input-error { outline: 2px solid var(--danger); border-color: var(--danger) !important; }

/* Wizard iniziale ---------------------------------------------------------- 
.setup-wizard{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:1.5rem;background:rgba(4,10,24,.8);backdrop-filter:blur(8px);z-index:1200}
.setup-wizard.hidden{display:none}
.wizard-card{width:min(720px,96vw);background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:18px;padding:1.8rem;box-shadow:0 28px 60px rgba(0,0,0,.45);display:flex;flex-direction:column;gap:1.2rem;position:relative;color:var(--text)}
.wizard-close{position:absolute;top:.9rem;right:.9rem;background:transparent;border:0;color:var(--muted);font-size:1.5rem;cursor:pointer}
.wizard-close:hover{color:#fff}
.wizard-progress{display:flex;gap:.45rem}
.wizard-progress span{flex:1;height:4px;border-radius:999px;background:rgba(255,255,255,.08);transition:background .25s ease}
.wizard-progress span.active{background:linear-gradient(90deg,var(--accent),var(--accent-2))}
.wizard-content{display:flex;flex-direction:column;gap:.75rem}
.wizard-step-icon{font-size:2.4rem}
.wizard-step-icon.hidden{display:none}
.wizard-step-title{margin:0;font-size:1.55rem;letter-spacing:.4px}
.wizard-step-body{color:var(--muted);font-size:.95rem;line-height:1.55}
.wizard-step-body ul{padding-left:1.2rem;margin:.6rem 0 0}
.wizard-step-body li{margin:.3rem 0}
.wizard-actions{display:flex;justify-content:space-between;align-items:center;gap:.75rem;flex-wrap:wrap}
.wizard-actions-nav{display:flex;gap:.6rem}
.wizard-skip{background:transparent;border:0;color:var(--muted);cursor:pointer;text-decoration:underline;font-size:.9rem;padding:.4rem .2rem}
.wizard-skip:hover{color:#fff}
body.wizard-open{overflow:hidden}

@media (max-width:520px){
  .wizard-card{padding:1.3rem}
  .wizard-step-title{font-size:1.4rem}
  .wizard-actions{flex-direction:column;align-items:stretch}
  .wizard-actions-nav{width:100%;justify-content:space-between}
  .wizard-actions-nav .btn{flex:1}
}*/